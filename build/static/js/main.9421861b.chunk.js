(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{114:function(e,t,a){},121:function(e,t){},123:function(e,t){},147:function(e,t){},150:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(33),s=a.n(o),c=(a(72),a(16)),i=a.n(c),l=a(34),u=a(12),h=a(4),m=a(5),d=a(7),f=a(6),p=a(8),g=(a(75),function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(d.a)(this,Object(f.a)(t).call(this,e))).getStyle=function(e){return"You"===e?{backgroundColor:"#FFDAB9",overflowY:"auto",opacity:.75}:{backgroundColor:"#FFD700",overflowY:"auto",opacity:.75}},a.determineVisualContent=function(e,t){if("undefined"==typeof e||null==typeof e)return null;if(e.length<=0)return null;var n=new RegExp(/(https:\/\/c\.simmer\.io\/static\/unityFrame\/index\.html\?url=https)([^a-z]+)(simmercdn.com%2Funity%2F)([a-zA-Z0-9]{28})(%2Fcontent%2F)([a-zA-Z0-9]{8}-[a-zA-Z0-9]{4}-[a-zA-Z0-9]{4}-[a-zA-Z0-9]{4}-[a-zA-Z0-9]{12}&imagePath=screens\/[a-zA-Z0-9]{1}.png)/),o=e.split("/");if("files.catbox.moe"===o[2]||"i.imgur.com"===o[2])return"mp4"==(o=o[3].split("."))[1]||"webm"==o[1]||"avi"==o[1]||"ogg"==o[1]||"mpeg"==o[1]?r.a.createElement("div",null,r.a.createElement("br",null),r.a.createElement("video",{ref:function(e){a.vidRef=e},onLoadedMetadata:a.scrollToBottomVideo,controls:!0,autoplay:!0}," ",r.a.createElement("source",{src:e}))," "):"jpg"==o[1]||"jpeg"==o[1]||"png"==o[1]||"gif"==o[1]?r.a.createElement("div",null,r.a.createElement("br",null),r.a.createElement("img",{src:e,alt:"User Content"})):null;if("www.youtube.com"===o[2]||"youtube.com"===o[2]||"youtu.be"===o[2]||"www.youtu.be"===o[2]){var s="https://youtube.com/embed/"+o[3].replace(/^.*(watch\?v=)/,"");return r.a.createElement("div",null,r.a.createElement("iframe",{width:"560",height:"315",src:s,frameborder:"0",allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:!0}))}if(n.test(e)){var c=n.exec(e)[0];return r.a.createElement("div",null,r.a.createElement("iframe",{src:c,style:{width:960,height:540,border:0}})," ",r.a.createElement("br",null))}if("www.twitch.tv"===o[2]||"twitch.tv"===o[2]){console.log(o[3]);var i="https://player.twitch.tv/?channel="+o[3];return r.a.createElement("div",null,r.a.createElement("br",null),r.a.createElement("iframe",{src:i,frameborder:"0",allowfullscreen:"true",scrolling:"no",height:"378",width:"620"}))}return null},a.hoverOn=function(){a.chatRef.style.opacity=1},a.hoverOff=function(){a.chatRef.style.opacity=.75},a.scrollToBottom=function(){a.chatRef.scrollIntoView({behavior:"smooth",block:"start"})},a.scrollToBottomVideo=function(){a.vidRef.scrollIntoView({behavior:"smooth",block:"start"})},a}return Object(p.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){this.scrollToBottom()}},{key:"componentDidUpdate",value:function(){this.scrollToBottom()}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{onMouseEnter:this.hoverOn,onMouseLeave:this.hoverOff,style:this.getStyle(this.props.chatItems.user),ref:function(t){e.chatRef=t}},this.props.chatItems.user+": "+this.props.chatItems.message,this.determineVisualContent(this.props.chatItems.message))}}]),t}(n.Component)),v=function(e){function t(){return Object(h.a)(this,t),Object(d.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return this.props.chatMessages.map(function(e){return r.a.createElement(g,{key:e.id,chatItems:e})})}}]),t}(n.Component),b=function(e){function t(){var e,a;Object(h.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(d.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).overlay=function(){a.overlayRef.remove()},a}return Object(p.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{id:"overlay",ref:function(t){e.overlayRef=t}},r.a.createElement("p",null,"Please check the ",r.a.createElement("b",null,"TOP RIGHT")," (in Chrome) ",r.a.createElement("b",null,"TOP LEFT")," (in Firefox) of your browser and make sure your webcam/mic is accessible to the browser!",r.a.createElement("br",null)),r.a.createElement("p",null,"Welcome to Random.moe!"),r.a.createElement("p",null,"Random.moe is an ",r.a.createElement("a",{href:"https://github.com/openpgpjs/openpgpjs"},"encrypted"),", ",r.a.createElement("a",{href:"https://github.com/feross/simple-peer"},"peer-to-peer"),", ",r.a.createElement("a",{href:"https://github.com/paradoxmoe/paradox"},"open source")," random chat alternative to Omegle/Chatroulette/etc."),r.a.createElement("p",null,"Special thanks to: ",r.a.createElement("a",{href:"http://stackoverflow.com/a/35387759"},"Kecer")," on Stackoverflow and ",r.a.createElement("a",{href:"https://codepen.io/Anomaly942/"},"Kaustav")," on CodePen"),r.a.createElement("p",null,"Youtube Support! Just Copy and Paste a youtube URL into the chat!"),r.a.createElement("iframe",{width:"560",height:"315",src:"https://www.youtube.com/embed/59UMqAvQoXk",frameborder:"0",allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:!0}),r.a.createElement("p",null,"Imgur support! "),r.a.createElement("p",null,r.a.createElement("a",{href:"www.twitch.tv"},"Twitch")," Support!"),r.a.createElement("p",null,r.a.createElement("a",{href:"http://catbox.moe"},"Catbox")," Support! Just Copy and Paste a Catbox.moe URL into the chat! (Images and videos!) "),r.a.createElement("p",null,r.a.createElement("a",{href:"https://simmer.io"},"Simmer Support!")," Just Copy and Paste the ",r.a.createElement("b",null,"embed code")," into the chat!"),r.a.createElement("p",null,"As the site is currently in Early Access, please report bugs or other issues ",r.a.createElement("a",{href:"https://github.com/paradoxmoe/RandomMOE/issues"},"here"),"!"),r.a.createElement("p",null,"Furthermore, as you are talking to random and anonymous users, please exercise caution when using this platform."),r.a.createElement("p",null,"We use cookies/local storage to store your PGP encryption keys, so be aware of this."),r.a.createElement("p",null,"If you'd like to contribute to the success of random.moe, please visit our ",r.a.createElement("a",{href:"https://www.patreon.com/randomMOE"},"Patreon"),"!"),r.a.createElement("button",{onClick:this.overlay},"Click here if you've read the above!"))}}]),t}(n.Component),y=function(e){function t(){var e,a;Object(h.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(d.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={content:""},a.onChange=function(e){return a.setState({content:e.target.value})},a.onSubmit=function(e){e.preventDefault(),a.props.createMessage("You",a.state.content),a.setState({content:"",user:"You"})},a}return Object(p.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement("form",{onSubmit:this.onSubmit,style:{position:"fixed",bottom:"0",width:"100%"}},r.a.createElement("input",{type:"text",name:"title",style:{flex:"10",padding:"5px",width:"90%"},placeholder:"Type Message Here...",value:this.state.content,onChange:this.onChange}),r.a.createElement("input",{type:"submit",value:"submit",className:"btn",style:{flex:"1"}}))}}]),t}(n.Component),w=(a(76),function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(d.a)(this,Object(f.a)(t).call(this,e))).lineGradient=function(e,t,n,r,o,s){var c=a.ctx.createLinearGradient(e,t,n,r);return c.addColorStop(0,o),c.addColorStop(1,s),c},a.radialGradient=function(e,t,n,r,o,s,c,i){var l=a.ctx.createRadialGradient(e,t,n,r,o,s,c,i);return l.addColorStop(0,c),l.addColorStop(1,i),l},a.rand=function(e,t){return Math.ceil(Math.random()*(t-e)+e)},a.canvasSize=function(){a.canvasRef.width=a.state.width,a.canvasRef.height=a.state.height},a.fill=function(e){a.fillcolor=e},a.stroke=function(e){a.strokecolor=e},a.border=function(e){a.strokesize=e},a.rect=function(e,t,n,r){a.ctx.fillStyle=a.fillcolor,a.ctx.strokeStyle=a.strokecolor,a.ctx.lineWidth=a.strokesize,a.ctx.beginPath(),a.ctx.rect(e,t,n,r),a.ctx.fill(),a.ctx.stroke(),a.ctx.closePath()},a.circle=function(e,t,n){a.ctx.fillStyle=a.fillcolor,a.ctx.strokeStyle=a.strokecolor,a.ctx.lineWidth=a.strokesize,a.ctx.beginPath(),a.ctx.arc(e,t,n,0,2*Math.PI,!1),a.ctx.fill(),a.ctx.stroke(),a.ctx.closePath()},a.point=function(e,t){a.ctx.fillStyle=a.fillcolor,a.ctx.strokeStyle=a.strokecolor,a.ctx.lineWidth=a.strokeSize,a.ctx.beginPath(),a.ctx.rect(e,t,1,1),a.ctx.fill(),a.ctx.stroke(),a.ctx.closePath()},a.canvasBackgroundFill=function(){a.fill(a.lineGradient(a.state.width/1,0,a.state.width/2,1.3*a.state.height,"#200030","#9c046e")),a.rect(0,0,a.state.width,a.state.height)},a.stars=function(){a.stroke("#ffffff"),a.border(1.5*Math.min(a.state.width/1440,a.state.height/900));for(var e=0;e<a.state.width/1.5;e++)a.point(a.rand(0,a.state.width),a.rand(0,a.state.width));a.stroke("#ffffff00")},a.sun=function(){var e=400*Math.min(a.state.width/1440,a.state.height/900);a.fill(a.lineGradient(a.state.width/2,0,a.state.width/2,1.1*a.state.height,"#ff4400","#ffff00")),a.circle(a.state.width/2,a.state.height/2,e)},a.water=function(){a.fill(a.radialGradient(a.state.width/2,a.state.height*(2/3),a.state.width/1440*100,a.state.width/2,a.state.height*(2/3),a.state.height/900*600,"#002244cc","#000044cc")),a.rect(0,a.state.height*(2/3),a.state.width,a.state.height/3)},a.onResize=function(){a.setState({width:window.innerWidth,height:window.innerHeight}),a.canvasSize(),a.createCanvasBackground()},a.createCanvasBackground=function(){a.canvasBackgroundFill(),a.stars(),a.sun(),a.water()},a.fillcolor="#000000",a.strokecolor="#000000",a.strokesize="#000000",a.state={width:window.innerWidth,height:window.innerHeight},a}return Object(p.a)(t,e),Object(m.a)(t,[{key:"componentWillMount",value:function(){}},{key:"componentDidMount",value:function(){this.ctx=this.canvasRef.getContext("2d"),this.setState({width:window.innerWidth,height:window.innerHeight}),window.addEventListener("resize",this.onResize),this.onResize(),this.createCanvasBackground()}},{key:"componentDidUpdate",value:function(){this.createCanvasBackground()}},{key:"render",value:function(){var e=this;return r.a.createElement("canvas",{ref:function(t){e.canvasRef=t}})}}]),t}(n.Component)),E=a(11),k=(a(114),a(65)),S=a.n(k),x=a(66),M=a.n(x);if(E.initWorker({path:"./dist/openpgp.worker.min.js"}),"undefined"==typeof localStorage.publicKey||"undefined"==typeof localStorage.privateKey||"undefined"==typeof localStorage.pass){var O=new Uint32Array(4);window.crypto.getRandomValues(O),localStorage.pass=O[2].toString();var C={userIds:[{name:O[3].toString(),email:O[0]+"@"+O[1]+".com"}],numBits:2048,passphrase:localStorage.pass};E.generateKey(C).then(function(e){localStorage.setItem("privateKey",e.privateKeyArmored),localStorage.setItem("publicKey",e.publicKeyArmored)})}var j=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(d.a)(this,Object(f.a)(t).call(this,e))).socketConnection=function(e){var t=M.a.connect("https://random.moe");a.setState({chatMessages:[].concat(Object(u.a)(a.state.chatMessages),[{id:a.state.chatMessages.length,user:"Client",message:"Connecting to Server..."}])}),t.on("peer",function(n){a.createPeer(n.initiator,e),console.log("Server told client to become initiator: "+n.initiator),n.initiator&&a.state.peer.on("signal",function(e){t.emit("initiatorData",e),a.setState({chatMessages:[].concat(Object(u.a)(a.state.chatMessages),[{id:a.state.chatMessages.length,user:"Client",message:"Emitting Initiator data to Server..."}])})})}),t.on("joinInitiator",function(e){if(a.setState({chatMessages:[].concat(Object(u.a)(a.state.chatMessages),[{id:a.state.chatMessages.length,user:"Client",message:"Joining Initiator..."}])}),a.state.peer.signal(e.data),!e.initiator){var n=e.socketid;a.state.peer.on("signal",function(e){t.emit("backToInitiator",{socketid:n,data:e}),a.setState({chatMessages:[].concat(Object(u.a)(a.state.chatMessages),[{id:a.state.chatMessages.length,user:"Client",message:"Recieving Initiator's Data..."}])})})}}),t.on("toInitiatorFromServer",function(e){a.state.peer.signal(e.data),a.setState({chatMessages:[].concat(Object(u.a)(a.state.chatMessages),[{id:a.state.chatMessages.length,user:"Client",message:"Connecting to Peer..."}])})})},a.submitButton=function(){console.log("Can Submit")},a.next=function(){a.setState({chatMessages:[].concat(Object(u.a)(a.state.chatMessages),[{id:a.state.chatMessages.length,user:"Client",message:"Finding User..."}])}),null!=a.state.peer&&"undefined"!=typeof a.state.peer&&(a.state.peer.destroy(),a.setState({chatMessages:[],peerInfo:null,stream:null,peer:null,inConvo:!1})),navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then(function(e){a.socketConnection(e)})},a.createPeer=function(e,t){var n=new S.a({initiator:e,trickle:!1,stream:t});return a.setState({inConvo:!0}),n.on("connect",function(){n.send(JSON.stringify({isPublicKey:!0,peerPublicKey:localStorage.publicKey})),a.setState({chatMessages:[]})}),n.on("data",function(){var e=Object(l.a)(i.a.mark(function e(t){var n,r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!0!==(t=JSON.parse(t)).isPublicKey){e.next=7;break}localStorage.setItem("peerPublicKey",t.peerPublicKey),console.log("Public Key Recieved!"),a.setState({chatMessages:[{id:a.state.chatMessages.length,user:"Client",message:"You can now send messages!"}]}),e.next=18;break;case 7:return e.next=9,E.key.readArmored(localStorage.privateKey);case 9:return n=e.sent.keys[0],e.next=12,n.decrypt(localStorage.pass);case 12:return e.next=14,E.message.readArmored(t.data);case 14:e.t0=e.sent,e.t1=[n],r={message:e.t0,privateKeys:e.t1},E.decrypt(r).then(function(e){var n={id:a.state.chatMessages.length,user:t.user,message:e.data};a.setState({chatMessages:[].concat(Object(u.a)(a.state.chatMessages),[n])})});case 18:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),n.on("stream",function(e){a.setState({peerStream:e}),a.peerRef.srcObject=a.state.peerStream,a.peerRef.onloaddedmetadata=a.peerRef.play()}),a.setState({peer:n,inConvo:!0}),n},a.createMessage=function(){var e=Object(l.a)(i.a.mark(function e(t,n){var r,o,s;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r={id:a.state.chatMessages.length,user:t,message:n},a.setState({chatMessages:[].concat(Object(u.a)(a.state.chatMessages),[r])}),o=E.message.fromText(n),e.t0=o,e.next=6,E.key.readArmored(localStorage.peerPublicKey);case 6:e.t1=e.sent.keys,s={message:e.t0,publicKeys:e.t1},E.encrypt(s).then(function(e){var t=e.data;a.state.peer.send(JSON.stringify({user:"Anon",data:t}))});case 9:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.state={chatMessages:[],peerInfo:null,stream:null,peer:null,inConvo:!1},a}return Object(p.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){var e=this;navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then(function(t){e.clientRef.srcObject=t,e.clientRef.onloaddedmetadata=e.clientRef.play(),e.forceUpdate()})}},{key:"componentDidCatch",value:function(e,t){console.log(e),console.log(t)}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"App"},r.a.createElement(b,null),r.a.createElement("div",{id:"videoChat"},r.a.createElement("div",null,r.a.createElement("h3",{id:"logo"},"Random.moe")," ",r.a.createElement("a",{href:"https://www.patreon.com/randomMOE"},"Patreon")," | ",r.a.createElement("a",{href:"https://twitter.com/Twitch_NotDem"},"Twitter")," | ",r.a.createElement("a",{href:"https://twitch.tv/notdem"},"Twitch")," | ",r.a.createElement("a",{href:"https://github.com/paradoxmoe/RandomMOE"},"Github")),r.a.createElement("video",{ref:function(t){e.clientRef=t},controls:!0,muted:!0}),r.a.createElement("video",{ref:function(t){e.peerRef=t},controls:!0})),r.a.createElement("div",{id:"chatApp",class:"disableScrollbars"},r.a.createElement(v,{chatMessages:this.state.chatMessages,submit:this.submitButton}),r.a.createElement("button",{type:"button",onClick:this.next,ref:function(t){e.findUsers=t}},"Next")),r.a.createElement(y,{createMessage:this.createMessage,peer:this.peer}),r.a.createElement(w,null))}}]),t}(n.Component);s.a.render(r.a.createElement(j,null),document.getElementById("root"))},67:function(e,t,a){e.exports=a(150)},72:function(e,t,a){},80:function(e,t){},82:function(e,t){}},[[67,1,2]]]);
//# sourceMappingURL=main.9421861b.chunk.js.map